{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job logger initialized for job 5b75e02b-5fd8-4733-9946-45ff44fe9535","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T20:55:50.785Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 started processing","metadata":{"data":{"aiService":"gemini","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T20:55:50.785Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Progress: 0% - Initialized","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T20:55:50.786Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job data extracted","metadata":{"aiService":"gemini","jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"timestamp":"2025-03-02T20:55:50.787Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting content processing","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22"},"timestamp":"2025-03-02T20:55:50.788Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Content processing completed","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","title":"السيرة النبوية   22  ولادة الدبلوماسية الإسلامية وأول معاركها الخارجية   محمد إلهامي","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T20:58:13.947Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting database transaction to save results","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T20:58:13.948Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing speaker","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda"},"timestamp":"2025-03-02T20:58:13.950Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing playlist","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0"},"timestamp":"2025-03-02T20:58:13.950Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Creating YouTube video entry","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T20:58:13.951Z"}
{"level":"error","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 failed","metadata":{"error":{"message":"Cannot read properties of undefined (reading 'slice')","name":"JobError","stack":"JobError: Cannot read properties of undefined (reading 'slice')\n    at processError (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\job-error-utils.ts:161:9)\n    at Worker.processJob (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\lesson-generation-worker.ts:210:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async <anonymous> (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:910:26)\n    at async Worker.retryIfFailed (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:1174:16)"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T20:58:14.058Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] METRIC.executionTime","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","metric":{"name":"executionTime","unit":"ms","value":143.272},"status":"failed"},"timestamp":"2025-03-02T20:58:14.059Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job logger initialized for job 5b75e02b-5fd8-4733-9946-45ff44fe9535","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:04:36.319Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 started processing","metadata":{"data":{"aiService":"gemini","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:04:36.320Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Progress: 0% - Initialized","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:04:36.320Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job data extracted","metadata":{"aiService":"gemini","jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"timestamp":"2025-03-02T21:04:36.321Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting content processing","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22"},"timestamp":"2025-03-02T21:04:36.323Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Content processing completed","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","title":"السيرة النبوية   22  ولادة الدبلوماسية الإسلامية وأول معاركها الخارجية   محمد إلهامي","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T21:06:47.351Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting database transaction to save results","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:06:47.353Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing speaker","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda"},"timestamp":"2025-03-02T21:06:47.359Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing playlist","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0"},"timestamp":"2025-03-02T21:06:47.361Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Creating YouTube video entry","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T21:06:47.364Z"}
{"level":"error","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 failed","metadata":{"error":{"message":"Cannot read properties of undefined (reading 'slice')","name":"JobError","stack":"JobError: Cannot read properties of undefined (reading 'slice')\n    at processError (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\job-error-utils.ts:161:9)\n    at Worker.processJob (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\lesson-generation-worker.ts:210:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async <anonymous> (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:910:26)\n    at async Worker.retryIfFailed (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:1174:16)"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:06:47.471Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] METRIC.executionTime","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","metric":{"name":"executionTime","unit":"ms","value":131.152},"status":"failed"},"timestamp":"2025-03-02T21:06:47.474Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job logger initialized for job 5b75e02b-5fd8-4733-9946-45ff44fe9535","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:12:35.970Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 started processing","metadata":{"data":{"aiService":"gemini","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:12:35.971Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Progress: 0% - Initialized","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:12:35.972Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job data extracted","metadata":{"aiService":"gemini","jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22","userId":"8a15ac58-4373-4eaf-ad86-4cfdf4b60abe"},"timestamp":"2025-03-02T21:12:35.972Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting content processing","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","url":"https://www.youtube.com/watch?v=WSrl2HS5o-Q&list=PLi0wnr6UH6EnuEwNMma1x8fhEVgEBT2uS&index=22"},"timestamp":"2025-03-02T21:12:35.973Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Content processing completed","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","title":"السيرة النبوية   22  ولادة الدبلوماسية الإسلامية وأول معاركها الخارجية   محمد إلهامي","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T21:14:51.277Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Starting database transaction to save results","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:14:51.278Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing speaker","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda"},"timestamp":"2025-03-02T21:14:51.282Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Using existing playlist","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0"},"timestamp":"2025-03-02T21:14:51.283Z"}
{"level":"debug","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Creating YouTube video entry","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","playlistId":"PLnpknmCXt_N5X7DKYKcYk5EkyW0-wmyJ0","speakerId":"c35d6b61-89d0-444b-8ef4-7a84725a0dda","videoId":"WSrl2HS5o-Q"},"timestamp":"2025-03-02T21:14:51.284Z"}
{"level":"error","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] Job 5b75e02b-5fd8-4733-9946-45ff44fe9535 failed","metadata":{"error":{"message":"Cannot read properties of undefined (reading 'slice')","name":"JobError","stack":"JobError: Cannot read properties of undefined (reading 'slice')\n    at processError (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\job-error-utils.ts:161:9)\n    at Worker.processJob (C:\\Users\\month\\workspace\\Merqam\\src\\server\\queue\\lesson-generation-worker.ts:210:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async <anonymous> (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:910:26)\n    at async Worker.retryIfFailed (C:\\Users\\month\\workspace\\Merqam\\node_modules\\bullmq\\src\\classes\\worker.ts:1174:16)"},"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535"},"timestamp":"2025-03-02T21:14:51.405Z"}
{"level":"info","message":"[lesson-generation:5b75e02b-5fd8-4733-9946-45ff44fe9535] METRIC.executionTime","metadata":{"jobId":"5b75e02b-5fd8-4733-9946-45ff44fe9535","metric":{"name":"executionTime","unit":"ms","value":135.434},"status":"failed"},"timestamp":"2025-03-02T21:14:51.407Z"}
